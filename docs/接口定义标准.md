# 接口定义文档
## 一、用户管理模块
### 1、用户注册
注:br渲染为换行符<br>
1.接口描述：用户输入用户名和密码，执行注册<br>
2.接口类型：Flask route<br>
3.请求方式：POST<br>
4.请求路径：/api/auth/register<br>
5.通信接口定义:<br>
- 客户端->服务器端:
{
    user_name: string;
    password: string
}
- 服务器端->客户端:
{
    message: string(fail/ok);
    data: {}(fail)、{
        user_id: number
        coins: number
    }(ok);
    error: string['detail'(fail)、''(ok)]
}<br>

6.版本号：v0.1.0<br>
7.最后修改时间：11-08

---

### 2、用户登录
1.接口描述：用户输入用户名和密码，执行登录<br>
2.接口类型：Flask route<br>
3.请求方式：POST<br>
4.请求路径：/api/auth/login<br>
5.通信接口定义:<br>
- 客户端->服务器端:
{
    user_name: string;
    password: string
}
- 服务器端->客户端:
{
    message: string(fail/ok);
    data: {}(fail)、{
        user_id: number
        coins: number
    }(ok);
    error: string['detail'(fail)、''(ok)]
}<br>

6.版本号：v0.1.0<br>
7.最后修改时间：11-08

---

### 3、获取用户信息
1.接口描述：用户点击头像，进入个人页面<br>
2.接口类型：Flask route<br>
3.请求方式：GET<br>
4.请求路径：/api/user<br>
5.通信接口定义:<br>
- 客户端->服务器端:
{
    user_id: number 
}
- 服务器端->客户端:
{
    message: string(fail/ok);
    data: {}(fail)、{
        coins: number
        bar_possess: number
        total_games: number
        win_games: number
        win_rate: number
        picture: string
    }(ok);
    error: string['detail'(fail)、''(ok)]
}<br>

6.版本号：v0.1.0<br>
7.最后修改时间：11-08

---

## 二、球杆管理模块
### 4、获取球杆列表(商城信息)
1.接口描述：用户点击商城，显示所有球杆<br>
2.接口类型：Flask route<br>
3.请求方式：GET<br>
4.请求路径：/api/bar/list<br>
5.通信接口定义:<br>
- 客户端->服务器端:
{
    user_id: number
}
- 服务器端->客户端:
{
    message: string(fail/ok);
    data: {}(fail)、{
        "bar_possess":[{"bar_id": number, "bar_name":string", "price":number}...]
        "bar_npossess":[{"bar_id": number, "bar_name":string", "price":number}...]
    }(ok);
    error: string['detail'(fail)、''(ok)]
}<br>
注：bar_possess代表**拥有**的所有球杆的信息，另一个则是未拥有的，两者均为字典列表<br>

6.版本号：v0.1.0<br>
7.最后修改时间：11-08

---

### 5、用户购买球杆
1.接口描述：用户点击球杆，进行购买<br>
2.接口类型：Flask route<br>
3.请求方式：POST<br>
4.请求路径：/api/bar/buy<br>
5.通信接口定义:<br>
- 客户端->服务器端:
{
    user_id: number
    bar_id: number
}
- 服务器端->客户端:
{
    message: string(fail/ok);
    data: {}(fail)、{
        coins: number;
        bar_possess: number
    }(ok);
    error: string['detail'(fail)、''(ok)]
}<br>

6.版本号：v0.1.0<br>
7.最后修改时间：11-08

---

## 三、房间管理模块
### 6、用户创建房间
1.接口描述：用户点击创建，服务器端生成对应房间<br>
2.接口类型：Flask route<br>
3.请求方式：POST<br>
4.请求路径：/api/room/create<br>
5.通信接口定义:<br>
- 客户端->服务器端:
{
    user_id: number
}
- 服务器端->客户端:
{
    message: string(fail/ok);
    data: {}(fail)、{
        room_id: number
    }(ok);
    error: string['detail'(fail)、''(ok)]
}<br>

6.版本号：v0.1.0<br>
7.最后修改时间：11-09

---

### 7、非创建者进入房间(仅更新数据库)
1.接口描述：非创建者进入房间，仅更新数据库<br>
2.接口类型：Flask route<br>
3.请求方式：POST<br>
4.请求路径：/api/room/join<br>
5.通信接口定义:<br>
- 客户端->服务器端:
{
    user_id: number
    room_id: number
}
- 服务器端->客户端:
{
    message: string(fail/ok);
    error: string['detail'(fail)、''(ok)]
}<br>

6.版本号：v0.1.0<br>
7.最后修改时间：11-09

---

### 8、用户进入房间(实时通信)
1.接口描述：用户进入房间，服务器进行播报<br>
2.接口类型：Flask socketio<br>
3.事件名：join_room<br>
4.请求方式：客户端通过 socket.emit("join_room", data) 发送，在创建房间和加入房间(接口6、7)调用后，再调用此函数
5.通信接口定义:<br>
- 客户端->服务器端:
{
    user_id: number
    room_id: number
}
- 服务器端->客户端:
{
    event:ok(创建者进入)/fail(进入失败)/game start(第二个玩家进入)
    data:{
        error: string['detail'(fail)、''(ok)]
        room_id: number(ok、gamestart)
        player1_id: number(game start)
        player2_id: number(game start)
        注：number(ok、gamestart)代表当event为ok/gamestart时返回字段中有room_id，否则无
}<br>
6.版本号：v0.1.0<br>
7.最后修改时间：11-09

---

接口名称: 用户击球
接口描述:
请求方式: POST
请求路径: /api/auth/strike
接口状态: 开发完成 
版本号: v0.0.0
C2S:
{
//type: string;
user_id: number;
data:
{
angle: number;
power: number;
}
}
S2C:
{
//type: string;
user_id: number;
data:
{
angle: number;
power: number;
}
}

接口名称: 位置数据核对接口
接口描述:
请求方式: POST
请求路径: /api/auth/position_check
接口状态: 已完成
版本号: v0.0.0
C2S:
{
//type: string;
user_id: number;
for(ball: balls):
{
id: number;
x: number;
y: number;
}
}
S2C:
{
receive_and_send();
}

接口名称: 确认下一次击球开始
接口描述:
请求方式: POST
请求路径: /api/auth/final_check
接口状态: 已完成
版本号: v0.0.0
C2S:
{
user_id: number;
//type: string;
}
S2C:
{
receive_and_send();
}
